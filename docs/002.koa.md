# Koa.js with TypeScript

- [koa.js](https://koajs.com)

## Installation

### packages

```bash
yarn add koa
yarn add --dev typescript \
               @types/koa \
               gulp gulp-typescript
```

### Gulp

Gulp: [Quick Start](https://gulpjs.com/docs/en/getting-started/quick-start)

Install the gulp command line utility.

```bash
npm install --global gulp-cli
```

---

## Project structure

```bash
mkdir src dist
```

### tsconfig.json

In the project root, create the file `tsconfig.json`

```json
{
  "compilerOptions": {
    "esModuleInterop": true,
    "noImplicitAny": true,
    "target": "es5"
  },
  "include": ["src"],
  "exclude": []
}
```

### gulpfile.js

In the project root, create the file `gulpfile.js`

```bash
const gulp = require('gulp')
const ts = require('gulp-typescript')
const tsProject = ts.createProject('tsconfig.json')

gulp.task('default', function () {
  return tsProject
    .src()
    .pipe(tsProject())
    .js.pipe(gulp.dest('dist'))
})
```

### main.ts

In `src`, create the file `main.ts`

```ts
import app from './app'

const PORT: string = process.env.PORT
const port: string = typeof PORT !== 'undefined' ? PORT : '8081'

app.listen(port, () => {
  console.log(`Server is listening on port ${port}.`)
})
```

### app.ts

In `src`, create the file `app.ts`

```ts
import Koa from 'koa'
const app = new Koa()

app.use(async ctx => {
  ctx.body = 'Hello, there.'
})

export default app
```

### Test resulting app

```bash
gulp
node .
```

Go to [localhost:8081](http://localhost:8081)
